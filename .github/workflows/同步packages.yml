name: 同步 packages

on: [push]

jobs:
  build:

    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v1
    - name: 初始化Git
      env:
        ACTION_DEPLOY_KEY: ${{ secrets.ID_RSA }}
      run: |
        mkdir -p ~/.ssh
        git config --global user.email "76885266@qq.com"
        git config --global user.name "Ouiae"
        echo "$ACTION_DEPLOY_KEY" > ~/.ssh/id_rsa
        chmod 600 ~/.ssh/id_rsa
        #ssh-keyscan github.com >> ~/.ssh/known_hosts
    - name: 拉取项目文件
      run: |
        git clone https://git.openwrt.org/feed/packages.git
        cd packages
        git init
        git add .
        git commit -m "first commit"
        git remote add origin git@gitee.com:ouiae/packages.git
        git push -u origin master
        #git remote set-url origin git@gitee.com:ouiae/packages.git
